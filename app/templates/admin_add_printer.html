{% extends "base.html" %}

{% block title %}Add Printer - Print Manager{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">
                    <i class="bi bi-printer-fill me-2"></i>Add New Printer
                </h5>
                <a href="{{ url_for('main.admin_printers') }}" class="btn btn-outline-secondary btn-sm">
                    <i class="bi bi-arrow-left me-1"></i>Back to Printers
                </a>
            </div>
            <div class="card-body">
                <form method="POST">
                    <!-- Basic Information -->
                    <h6 class="mb-3">Basic Information</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="name" class="form-label">Printer Name *</label>
                                <input type="text" class="form-control" name="name" required
                                       placeholder="e.g., HP LaserJet Pro 1">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="model" class="form-label">Model</label>
                                <input type="text" class="form-control" name="model"
                                       placeholder="e.g., HP LaserJet Pro M404dn">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label for="location" class="form-label">Location</label>
                                <input type="text" class="form-control" name="location"
                                       placeholder="e.g., Office Floor 1, Room 101">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="status" class="form-label">Status</label>
                                <select class="form-select" name="status">
                                    <option value="offline">Offline</option>
                                    <option value="online">Online</option>
                                    <option value="maintenance">Maintenance</option>
                                    <option value="error">Error</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Network Configuration -->
                    <h6 class="mb-3 mt-4">Network Configuration</h6>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label for="ip_address" class="form-label">IP Address</label>
                                <input type="text" class="form-control" name="ip_address"
                                       placeholder="e.g., 192.168.1.100">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="port" class="form-label">Port</label>
                                <input type="number" class="form-control" name="port" value="9100"
                                       min="1" max="65535">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Capabilities -->
                    <h6 class="mb-3 mt-4">Printer Capabilities</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="max_paper_size" class="form-label">Maximum Paper Size</label>
                                <select class="form-select" name="max_paper_size">
                                    <option value="A4" selected>A4</option>
                                    <option value="A3">A3</option>
                                    <option value="Letter">Letter</option>
                                    <option value="Legal">Legal</option>
                                    <option value="Tabloid">Tabloid</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Features</label>
                                <div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="supports_color" checked>
                                        <label class="form-check-label">
                                            Color Printing
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="supports_duplex" checked>
                                        <label class="form-check-label">
                                            Duplex (Double-sided) Printing
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="supports_scanning">
                                        <label class="form-check-label">
                                            Scanning Capability
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status and Levels -->
                    <h6 class="mb-3 mt-4">Current Levels</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="toner_level" class="form-label">Toner Level (%)</label>
                                <input type="range" class="form-range" name="toner_level" 
                                       min="0" max="100" value="100" oninput="updateTonerValue(this.value)">
                                <small class="text-muted">Current: <span id="toner_value">100</span>%</small>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="paper_level" class="form-label">Paper Level (%)</label>
                                <input type="range" class="form-range" name="paper_level" 
                                       min="0" max="100" value="100" oninput="updatePaperValue(this.value)">
                                <small class="text-muted">Current: <span id="paper_value">100</span>%</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings -->
                    <h6 class="mb-3 mt-4">Settings</h6>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="is_active" checked>
                            <label class="form-check-label">
                                <strong>Active</strong> - Printer is available for use
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="is_default">
                            <label class="form-check-label">
                                <strong>Default Printer</strong> - Use as default for new jobs
                            </label>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('main.admin_printers') }}" class="btn btn-secondary">Cancel</a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-plus-circle me-1"></i>Add Printer
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
function updateTonerValue(value) {
    document.getElementById('toner_value').textContent = value;
}

function updatePaperValue(value) {
    document.getElementById('paper_value').textContent = value;
}

// Auto-discovery simulation
function discoverPrinters() {
    const button = event.target;
    button.disabled = true;
    button.innerHTML = '<i class="bi bi-arrow-clockwise me-1"></i>Discovering...';
    
    // Simulate discovery
    setTimeout(() => {
        button.disabled = false;
        button.innerHTML = '<i class="bi bi-search me-1"></i>Auto-Discover';
        
        // For demo, fill in some discovered data
        document.querySelector('input[name="name"]').value = 'Discovered Printer';
        document.querySelector('input[name="ip_address"]').value = '192.168.1.201';
        document.querySelector('input[name="model"]').value = 'HP LaserJet Pro M404n';
        
        alert('Printer discovered! Please verify the information and adjust as needed.');
    }, 2000);
}
</script>
{% endblock %}
